# Mask Truffle AI - åŒºå—é“¾æ•°æ®ä¸Šé“¾ç³»ç»Ÿ

åŸºäºTruffleå’ŒReactçš„åŒºå—é“¾æ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢ç³»ç»Ÿï¼Œå®ç°æ•°æ®çš„é“¾ä¸Šå­˜å‚¨ã€æŸ¥è¯¢å’Œç®¡ç†åŠŸèƒ½ã€‚

## ğŸš€ é¡¹ç›®ç‰¹æ€§

- **æ™ºèƒ½åˆçº¦**: ä½¿ç”¨Solidityå¼€å‘çš„æ•°æ®å­˜å‚¨åˆçº¦ï¼Œæ”¯æŒæ•°æ®ä¸Šé“¾ã€æŸ¥è¯¢ã€æ›´æ–°å’Œåœç”¨
- **å‰ç«¯ç•Œé¢**: åŸºäºReact + Ant Designçš„ç°ä»£åŒ–ç”¨æˆ·ç•Œé¢
- **é’±åŒ…é›†æˆ**: æ”¯æŒMetaMaskç­‰Web3é’±åŒ…è¿æ¥
- **å¤šç½‘ç»œæ”¯æŒ**: æ”¯æŒä¸»ç½‘ã€æµ‹è¯•ç½‘å’Œæœ¬åœ°å¼€å‘ç½‘ç»œ
- **æ•°æ®æŸ¥è¯¢**: æ”¯æŒå¤šç§æŸ¥è¯¢æ–¹å¼ï¼šæŒ‰ç±»å‹ã€åˆ›å»ºè€…ã€IDç­‰
- **å®æ—¶ç»Ÿè®¡**: æ˜¾ç¤ºé“¾ä¸Šæ•°æ®ç»Ÿè®¡ä¿¡æ¯
- **å“åº”å¼è®¾è®¡**: é€‚é…ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯

## ğŸ“‹ æŠ€æœ¯æ ˆ

### åç«¯ (åŒºå—é“¾)
- **Solidity** ^0.8.19 - æ™ºèƒ½åˆçº¦å¼€å‘
- **Truffle** ^5.11.5 - å¼€å‘æ¡†æ¶
- **OpenZeppelin** ^4.9.3 - å®‰å…¨åˆçº¦åº“
- **HDWallet Provider** - é’±åŒ…è¿æ¥

### å‰ç«¯
- **React** ^18.2.0 - ç”¨æˆ·ç•Œé¢
- **Ethers.js** ^5.7.2 - åŒºå—é“¾äº¤äº’
- **Web3-React** - é’±åŒ…è¿æ¥ç®¡ç†
- **Ant Design** ^5.6.1 - UIç»„ä»¶åº“
- **React Hooks** - çŠ¶æ€ç®¡ç†

## ğŸ› ï¸ å®‰è£…ä¸è¿è¡Œ

### ç¯å¢ƒè¦æ±‚
- Node.js >= 16.0.0
- npm >= 8.0.0
- MetaMask æµè§ˆå™¨æ‰©å±•
- Ganache CLI (æœ¬åœ°å¼€å‘)

### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/juzhiqiang/mask-truffle-ai.git
cd mask-truffle-ai
```

### 2. å®‰è£…ä¾èµ–
```bash
# å®‰è£…æ ¹ç›®å½•å’Œå®¢æˆ·ç«¯ä¾èµ–
npm run install-all

# æˆ–è€…åˆ†åˆ«å®‰è£…
npm install
cd client && npm install
```

### 3. ç¯å¢ƒé…ç½®
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®ä»¥ä¸‹å˜é‡ï¼š
INFURA_PROJECT_ID=your_infura_project_id
MNEMONIC=your_wallet_mnemonic_phrase
REACT_APP_INFURA_ID=your_infura_project_id
REACT_APP_NETWORK=sepolia
```

### 4. ç¼–è¯‘æ™ºèƒ½åˆçº¦
```bash
npm run compile
```

### 5. éƒ¨ç½²åˆçº¦

#### æœ¬åœ°å¼€å‘ç½‘ç»œ
```bash
# å¯åŠ¨Ganache (æ–°ç»ˆç«¯)
npx ganache-cli

# éƒ¨ç½²åˆ°æœ¬åœ°ç½‘ç»œ
npm run migrate
```

#### æµ‹è¯•ç½‘ç»œ (Sepolia)
```bash
# éƒ¨ç½²åˆ°Sepoliaæµ‹è¯•ç½‘
truffle migrate --network sepolia
```

### 6. æ›´æ–°å‰ç«¯é…ç½®
éƒ¨ç½²æˆåŠŸåï¼Œå°†åˆçº¦åœ°å€æ›´æ–°åˆ° `client/src/services/DataStorageService.js` ä¸­çš„ `CONTRACT_ADDRESS`ã€‚

### 7. å¯åŠ¨å‰ç«¯åº”ç”¨
```bash
npm run dev
# æˆ–è€…
cd client && npm start
```

åº”ç”¨å°†åœ¨ http://localhost:3000 ä¸Šè¿è¡Œã€‚

## ğŸ”§ é¡¹ç›®ç»“æ„

```
mask-truffle-ai/
â”œâ”€â”€ contracts/                 # æ™ºèƒ½åˆçº¦
â”‚   â”œâ”€â”€ DataStorage.sol        # ä¸»æ•°æ®å­˜å‚¨åˆçº¦
â”‚   â””â”€â”€ Migrations.sol         # Truffleè¿ç§»åˆçº¦
â”œâ”€â”€ migrations/                # éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ 1_initial_migration.js
â”‚   â””â”€â”€ 2_deploy_contracts.js
â”œâ”€â”€ test/                      # åˆçº¦æµ‹è¯•
â”‚   â””â”€â”€ DataStorage.test.js
â”œâ”€â”€ client/                    # Reactå‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/        # ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ WalletConnection.js
â”‚   â”‚   â”œâ”€â”€ services/          # æœåŠ¡ç±»
â”‚   â”‚   â”‚   â””â”€â”€ DataStorageService.js
â”‚   â”‚   â”œâ”€â”€ App.js            # ä¸»ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ App.css           # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ index.js          # å…¥å£æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ index.css
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ truffle-config.js         # Truffleé…ç½®
â”œâ”€â”€ package.json              # é¡¹ç›®ä¾èµ–
â””â”€â”€ .env.example              # ç¯å¢ƒå˜é‡æ¨¡æ¿
```

## ğŸ’¡ ä½¿ç”¨æŒ‡å—

### è¿æ¥é’±åŒ…
1. ç¡®ä¿å·²å®‰è£…MetaMaskæµè§ˆå™¨æ‰©å±•
2. ç‚¹å‡»å³ä¸Šè§’çš„"è¿æ¥é’±åŒ…"æŒ‰é’®
3. åœ¨å¼¹å‡ºçš„MetaMaskä¸­ç¡®è®¤è¿æ¥
4. è¿æ¥æˆåŠŸåå¯ä»¥çœ‹åˆ°é’±åŒ…åœ°å€å’Œç½‘ç»œä¿¡æ¯

### æ•°æ®ä¸Šé“¾
1. ç‚¹å‡»ä¾§è¾¹æ çš„"æ·»åŠ æ•°æ®"æŒ‰é’®
2. è¾“å…¥æ•°æ®ç±»å‹å’Œå†…å®¹
3. ç‚¹å‡»"ä¸Šé“¾"æŒ‰é’®
4. åœ¨MetaMaskä¸­ç¡®è®¤äº¤æ˜“
5. ç­‰å¾…äº¤æ˜“å®Œæˆ

### æ•°æ®æŸ¥è¯¢
- **æŸ¥çœ‹å…¨éƒ¨**: æ˜¾ç¤ºæ‰€æœ‰æ´»è·ƒçš„æ•°æ®è®°å½•
- **æŒ‰ç±»å‹æŸ¥è¯¢**: è¾“å…¥æ•°æ®ç±»å‹è¿›è¡Œç­›é€‰
- **æŒ‰åˆ›å»ºè€…æŸ¥è¯¢**: è¾“å…¥é’±åŒ…åœ°å€æŸ¥è¯¢è¯¥åœ°å€åˆ›å»ºçš„æ•°æ®
- **æŒ‰IDæŸ¥è¯¢**: è¾“å…¥è®°å½•IDæŸ¥è¯¢ç‰¹å®šæ•°æ®

### æ•°æ®ç®¡ç†
- æŸ¥çœ‹æ•°æ®è¯¦æƒ…ã€åˆ›å»ºæ—¶é—´å’Œåˆ›å»ºè€…
- æ”¯æŒæ•°æ®åˆ†é¡µæµè§ˆ
- å®æ—¶ç»Ÿè®¡æ˜¾ç¤ºæ€»è®°å½•æ•°å’Œæ´»è·ƒè®°å½•æ•°

## ğŸ§ª æµ‹è¯•

è¿è¡Œæ™ºèƒ½åˆçº¦æµ‹è¯•ï¼š
```bash
npm test
# æˆ–è€…
truffle test
```

æµ‹è¯•è¦†ç›–ä»¥ä¸‹åŠŸèƒ½ï¼š
- æ•°æ®å­˜å‚¨åŠŸèƒ½
- æ•°æ®æ£€ç´¢åŠŸèƒ½
- æ•°æ®æ›´æ–°åŠŸèƒ½
- æƒé™æ§åˆ¶
- æ•°æ®åˆ†é¡µ

## ğŸ“ æ™ºèƒ½åˆçº¦åŠŸèƒ½

### DataStorage.sol ä¸»è¦æ–¹æ³•

- `storeData(string dataType, string content)`: å­˜å‚¨æ•°æ®åˆ°åŒºå—é“¾
- `getDataRecord(uint256 recordId)`: æ ¹æ®IDè·å–æ•°æ®è®°å½•
- `getActiveRecords(uint256 offset, uint256 limit)`: åˆ†é¡µè·å–æ´»è·ƒè®°å½•
- `getRecordsByType(string dataType)`: æ ¹æ®ç±»å‹è·å–è®°å½•IDåˆ—è¡¨
- `getRecordsByCreator(address creator)`: æ ¹æ®åˆ›å»ºè€…è·å–è®°å½•IDåˆ—è¡¨
- `updateData(uint256 recordId, string newContent)`: æ›´æ–°æ•°æ®å†…å®¹
- `deactivateData(uint256 recordId)`: åœç”¨æ•°æ®è®°å½•
- `getStats()`: è·å–ç»Ÿè®¡ä¿¡æ¯

### äº‹ä»¶
- `DataStored`: æ•°æ®å­˜å‚¨äº‹ä»¶
- `DataUpdated`: æ•°æ®æ›´æ–°äº‹ä»¶
- `DataDeactivated`: æ•°æ®åœç”¨äº‹ä»¶

## ğŸŒ ç½‘ç»œé…ç½®

### æ”¯æŒçš„ç½‘ç»œ
- **Mainnet**: ä»¥å¤ªåŠä¸»ç½‘
- **Sepolia**: æµ‹è¯•ç½‘ç»œ
- **Development**: æœ¬åœ°Ganacheç½‘ç»œ

### ç½‘ç»œåˆ‡æ¢
åœ¨MetaMaskä¸­åˆ‡æ¢åˆ°å¯¹åº”ç½‘ç»œï¼Œåº”ç”¨ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶è¿æ¥ã€‚

## ğŸ” å®‰å…¨ç‰¹æ€§

- **è®¿é—®æ§åˆ¶**: åªæœ‰æ•°æ®åˆ›å»ºè€…å¯ä»¥æ›´æ–°æˆ–åœç”¨è‡ªå·±çš„æ•°æ®
- **é‡å…¥æ”»å‡»é˜²æŠ¤**: ä½¿ç”¨OpenZeppelinçš„ReentrancyGuard
- **æ‰€æœ‰æƒç®¡ç†**: åˆçº¦æ‰€æœ‰è€…å…·æœ‰ç®¡ç†æƒé™
- **æ•°æ®éªŒè¯**: ä¸¥æ ¼çš„è¾“å…¥éªŒè¯å’Œé”™è¯¯å¤„ç†

## ğŸš§ å¼€å‘è®¡åˆ’

- [ ] æ·»åŠ æ•°æ®åŠ å¯†åŠŸèƒ½
- [ ] å®ç°æ•°æ®æ‰¹é‡æ“ä½œ
- [ ] æ·»åŠ æ•°æ®å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½
- [ ] æ”¯æŒæ›´å¤šé’±åŒ…è¿æ¥æ–¹å¼
- [ ] ä¼˜åŒ–gasè´¹ç”¨æ¶ˆè€—
- [ ] æ·»åŠ æ•°æ®å¯è§†åŒ–å›¾è¡¨
- [ ] å®ç°å¤šè¯­è¨€æ”¯æŒ
- [ ] æ·»åŠ æ•°æ®å¤‡ä»½åŠŸèƒ½

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork è¿™ä¸ªä»“åº“
2. åˆ›å»ºä½ çš„ç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤ä½ çš„æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ä¸€ä¸ª Pull Request

## ğŸ“„ è®¸å¯è¯

è¿™ä¸ªé¡¹ç›®ä½¿ç”¨ MIT è®¸å¯è¯ã€‚æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£æ›´å¤šè¯¦æƒ…ã€‚

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: MetaMaskè¿æ¥å¤±è´¥**
A: ç¡®ä¿å·²å®‰è£…MetaMaskæ‰©å±•ï¼Œå¹¶ä¸”å·²è§£é”é’±åŒ…

**Q: äº¤æ˜“å¤±è´¥**
A: æ£€æŸ¥é’±åŒ…ä½™é¢æ˜¯å¦è¶³å¤Ÿæ”¯ä»˜gasè´¹ç”¨ï¼Œç¡®è®¤ç½‘ç»œè®¾ç½®æ­£ç¡®

**Q: æ‰¾ä¸åˆ°åˆçº¦**
A: ç¡®ä¿åˆçº¦å·²æ­£ç¡®éƒ¨ç½²ï¼Œå¹¶ä¸”å‰ç«¯é…ç½®äº†æ­£ç¡®çš„åˆçº¦åœ°å€

**Q: æ•°æ®åŠ è½½å¤±è´¥**
A: æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œç¡®è®¤è¿æ¥åˆ°æ­£ç¡®çš„åŒºå—é“¾ç½‘ç»œ

### è·å–å¸®åŠ©
- æäº¤ [GitHub Issues](https://github.com/juzhiqiang/mask-truffle-ai/issues)
- æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£
- è”ç³»é¡¹ç›®ç»´æŠ¤è€…

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š
- [Truffle Suite](https://trufflesuite.com/)
- [OpenZeppelin](https://openzeppelin.com/)
- [React](https://reactjs.org/)
- [Ant Design](https://ant.design/)
- [Ethers.js](https://ethers.io/)

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªStaræ”¯æŒä¸€ä¸‹ï¼**
